<% @rating_types = RatingType.all %>

<div class="slidecontainer">
  <p>
    <label>Text Language</label>
    <%= select_tag "issue[language_id]", (options_for_select(Language.all.collect { |p| [ p.value, p.id ] }, :selected => @issue.issue_language.try(:value) )), {:include_blank => true} %>
  </p>
</div>

<% if @issue.status.name == 'Closed' || @issue.status.name == 'Done' %>
  <div class="slidecontainer">
    <% @rating_types.each do |rt| %>
      <p>
        <% rating = CaRating.find_by(type_id: rt.id, issue_id: @issue.id) %>
        <label><%= rt.value %></label>
        <%= range_field_tag "issue[rating_#{rt.value}]", value = rating.try(:value), in: 1..10, step: 1, :oninput=> "rating_#{rt.value}.value = issue_rating_#{rt.value}.value" %>
        <%= content_tag( :output, "#{rating.try(:value)}", :id=>"rating_#{rt.value}") %>
      </p>
    <% end %>
  </div>
<% end %>
